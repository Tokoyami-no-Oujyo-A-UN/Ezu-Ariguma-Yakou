<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>キャラクター巻物 - 旧端末版</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow-x: auto;
  overflow-y: hidden;
  height: 100%;
  font-family: sans-serif;
  background: #000 url('bg.jpg') no-repeat center center fixed;
  background-size: cover;
}

#scroll-container {
  white-space: nowrap;
  height: 100%;
}

.character {
  display: inline-block;
  vertical-align: top;
  position: relative;
  text-align: center;
}

.character img.char-img {
  display: block;
  height: 100%;
}

.kumo {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  z-index: 1;
}

.nav-btn {
  display: block;
  margin: 15px auto 0;
  width: 50px; /* 固定サイズ */
  height: 50px;
  cursor: pointer;
}

#detail-panel {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  max-height: 40%;
  background-color: rgba(0,0,0,0.7);
  color: #fff;
  padding: 10px;
  display: none;
  z-index: 100;
  overflow-y: auto;
}

#detail-close {
  position: absolute;
  top: 5px;
  right: 5px;
  width: 30px;
  height: 30px;
  cursor: pointer;
}
</style>
</head>
<body>
<div id="scroll-container"></div>

<div id="detail-panel">
  <div id="detail-close"><img src="0moji_cl.png" style="width:100%; height:100%;"></div>
  <div id="detail-text"></div>
</div>

<script>
// キャラクターマップ
const charMap = {
  1: { img:"01.png", kumo:"kumo_b.png", txt:"01.txt" },
  2: { img:"02.png", kumo:"kumo_k.png", txt:"02.txt" },
  3: { img:"03.png", kumo:"kumo_w.png", txt:"03.txt" },
  4: { img:"04.png", kumo:"kumo_b.png", txt:"04.txt" }
};

const container = document.getElementById('scroll-container');
const detailPanel = document.getElementById('detail-panel');
const detailText = document.getElementById('detail-text');
const detailClose = document.getElementById('detail-close');

// 画面サイズ取得
function adjustHeight(){
  const h = window.innerHeight;
  const imgs = document.querySelectorAll('.char-img');
  imgs.forEach(img => img.style.height = h + 'px');
}
window.addEventListener('resize', adjustHeight);

// キャラクターとナビボタン生成
Object.keys(charMap).forEach(idx=>{
  const c = charMap[idx];
  const div = document.createElement('div');
  div.className = 'character';

  // 雲
  const kumoImg = document.createElement('img');
  kumoImg.className = 'kumo';
  kumoImg.src = c.kumo;
  div.appendChild(kumoImg);

  // キャラ画像
  const charImg = document.createElement('img');
  charImg.className = 'char-img';
  charImg.src = c.img;
  div.appendChild(charImg);

  // 左ボタン
  const leftBtn = document.createElement('a');
  leftBtn.href = `#${('0'+(idx-1)).slice(-2)}`;
  const leftImg = document.createElement('img');
  leftImg.src = '0left.png';
  leftImg.className = 'nav-btn';
  leftBtn.appendChild(leftImg);
  div.appendChild(leftBtn);

  // 右ボタン
  const rightBtn = document.createElement('a');
  rightBtn.href = `#${('0'+(parseInt(idx)+1)).slice(-2)}`;
  const rightImg = document.createElement('img');
  rightImg.src = '0right.png';
  rightImg.className = 'nav-btn';
  rightBtn.appendChild(rightImg);
  div.appendChild(rightBtn);

  // 詳細ボタン
  const detailBtn = document.createElement('img');
  detailBtn.src = '0moji_op.png';
  detailBtn.className = 'nav-btn';
  detailBtn.style.cursor = 'pointer';
  detailBtn.addEventListener('click',()=>{
    fetch(c.txt).then(r=>r.text()).then(txt=>{
      detailText.innerText = txt;
      detailPanel.style.display='block';
    });
  });
  div.appendChild(detailBtn);

  container.appendChild(div);
});

// 詳細閉じる
detailClose.addEventListener('click',()=>{
  detailPanel.style.display='none';
  detailText.innerText='';
});

adjustHeight();
</script>
</body>
</html>
